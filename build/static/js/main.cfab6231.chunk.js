(this["webpackJsonproom-sensors"]=this["webpackJsonproom-sensors"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},233:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n.n(s),a=n(91),r=n.n(a),o=n(6),i=(n(100),n(101),n(4)),l=n(3),u=n(8),j=n(10),d=n.n(j),b=n(21),m=n(22),O=n.n(m),p="localhost:9999",h=function(){var e=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... getting rooms"),t="http://".concat(p,"/api/rooms"),e.next=4,O.a.get(t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... creating room"),n="http://".concat(p,"/api/rooms"),e.next=4,O.a.post(n,t);case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... deleting room"),n="http://".concat(p,"/api/rooms/").concat(t),e.next=4,O.a.delete(n);case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... updating room"),s="http://".concat(p,"/api/rooms/").concat(t),e.next=4,O.a.put(s,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... getting sensors"),n="http://".concat(p,"/api/rooms/").concat(t,"/sensors"),e.next=4,O.a.get(n);case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... creating room"),s="http://".concat(p,"/api/rooms/").concat(t,"/sensors"),e.next=4,O.a.post(s,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... deleting sensor"),s="http://".concat(p,"/api/rooms/").concat(t,"/sensors/").concat(n),e.next=4,O.a.delete(s);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... getting sensor values"),s="http://".concat(p,"/api/rooms/").concat(t,"/sensors/").concat(n,"/measurements"),e.next=4,O.a.get(s);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k=n(0),S=function(){var e=Object(i.g)(),t=Object(s.useState)(""),n=Object(u.a)(t,2),c=n[0],a=n[1],r=Object(s.useState)(""),o=Object(u.a)(r,2),j=o[0],d=o[1],b=Object(s.useState)(""),m=Object(u.a)(b,2),O=m[0],p=m[1],h=Object(l.d)((function(e){return e.addRoom}));return Object(k.jsx)("div",{className:"column",children:Object(k.jsxs)("div",{className:"card m-4 p-4",children:[Object(k.jsx)("div",{className:"title is-3",children:"Add room"}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Name"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{value:c,onChange:function(e){return a(e.target.value)},className:"input",type:"text",placeholder:"Room name"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Description"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("textarea",{value:j,onChange:function(e){return d(e.target.value)},className:"textarea",type:"text",placeholder:"Room description"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Id"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{value:O,onChange:function(e){return p(e.target.value)},className:"input",type:"number",min:"1",step:"1",placeholder:"Unique id"})})]}),Object(k.jsx)("div",{className:"field mt-4",children:Object(k.jsx)("div",{className:"control",children:Object(k.jsx)("button",{className:"button is-primary",onClick:function(){x({name:c,description:j,id:O,sensors:0}).then((function(t){t.message&&(h({name:c,description:j,id:O,sensors:0}),e.push("/"))}))},children:"Save"})})})]})})},C=function(){var e=Object(s.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(u.a)(a,2),o=r[0],j=r[1],d=Object(s.useState)(""),b=Object(u.a)(d,2),m=b[0],O=b[1],p=Object(s.useState)(""),h=Object(u.a)(p,2),x=h[0],f=h[1],N=Object(s.useState)(""),w=Object(u.a)(N,2),y=w[0],S=w[1],C=Object(i.h)().room_id,_=Object(i.g)(),R=Object(l.e)((function(e){return e.rooms})),T=Object(l.d)((function(e){return e.updateRoom}));return Object(k.jsx)("div",{className:"column",children:Object(k.jsxs)("div",{className:"card m-4 p-4",children:[Object(k.jsx)("div",{className:"title is-3",children:"Add Sensor"}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Name"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{onChange:function(e){return c(e.target.value)},value:n,className:"input",type:"text",placeholder:"Sensor name"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Description"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("textarea",{onChange:function(e){return j(e.target.value)},value:o,className:"textarea",type:"text",placeholder:"Sensor description"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Variable"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{onChange:function(e){return O(e.target.value)},value:m,className:"input",type:"text",placeholder:"Ex: Temperature"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Unit"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{onChange:function(e){return f(e.target.value)},value:x,className:"input",type:"text",placeholder:"Ex: \u0970C"})})]}),Object(k.jsxs)("div",{className:"field",children:[Object(k.jsx)("label",{className:"label",children:"Id"}),Object(k.jsx)("p",{className:"control",children:Object(k.jsx)("input",{onChange:function(e){return S(e.target.value)},value:y,className:"input",type:"number",min:"1",step:"1",placeholder:"Unique id"})})]}),Object(k.jsx)("div",{className:"field mt-4",children:Object(k.jsx)("div",{className:"control",children:Object(k.jsx)("button",{className:"button is-primary",onClick:function(){var e={name:n,description:o,variable:m,unit:x,id:y},t=R.filter((function(e){return e.id==C}))[0].sensors;g(C,e).then((function(e){return console.log("sensor created")})),v(C,{sensors:t+1}).then((function(e){T(C,{sensors:t+1}),_.push("/room/".concat(C))}))},children:"Save"})})})]})})},_=n(18),R=n(17),T=function(){var e=Object(s.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(null),r=Object(u.a)(a,2),i=r[0],j=r[1],d=Object(l.e)((function(e){return e.rooms})),b=Object(l.e)((function(e){return e.sensors})),m=Object(l.d)((function(e){return e.setRooms}));return Object(s.useEffect)((function(){h().then((function(e){return m(e.rooms)}))}),[]),Object(k.jsxs)("aside",{className:"menu column is-one-fifth m-4",children:[Object(k.jsx)("p",{className:"menu-label has-text-link",children:Object(k.jsx)(o.b,{to:"/rooms",onClick:function(){c(null),j(null)},children:"Rooms"})}),Object(k.jsxs)("ul",{className:"menu-list",children:[d.map((function(e){return Object(k.jsxs)("li",{children:[Object(k.jsx)(o.b,{to:"/room/".concat(e.id),onClick:function(){c(e.id),j(null)},className:e.id==n?"is-active":"",children:e.name}),e.id==n?Object(k.jsxs)("ul",{children:[b.map((function(t){return Object(k.jsx)("li",{children:Object(k.jsx)(o.b,{to:"/room/".concat(e.id,"/sensor/").concat(t.id),onClick:function(){return j(t.id)},className:t.id==i?"is-active":"",children:t.name})})})),Object(k.jsx)("li",{children:Object(k.jsxs)(o.b,{onClick:function(){return j(null)},to:"/add_sensor/".concat(e.id),children:[Object(k.jsx)("span",{className:"has-text-link",children:Object(k.jsx)(R.a,{icon:_.a})}),Object(k.jsx)("span",{className:"ml-2",children:"Add sensor"})]})})]}):""]})})),Object(k.jsx)("li",{children:Object(k.jsxs)(o.b,{to:"/add_room",onClick:function(){return c(null)},children:[Object(k.jsx)("span",{className:"has-text-link",children:Object(k.jsx)(R.a,{icon:_.a})}),Object(k.jsx)("span",{className:"ml-2",children:"Add room"})]})})]})]})},M=function(){var e=Object(l.e)((function(e){return e.rooms}));return Object(k.jsxs)("div",{className:"column",children:[Object(k.jsx)("h1",{className:"title is-3 m-4",children:"Rooms"}),Object(k.jsxs)("div",{class:"is-flex is-flex-wrap-wrap",children:[e.map((function(e){return Object(k.jsx)("div",{className:"card m-4",children:Object(k.jsx)(o.b,{to:"/room/".concat(e.id),children:Object(k.jsxs)("div",{className:"card-content",children:[Object(k.jsxs)("p",{className:"title is-3",children:[e.name," ",Object(k.jsxs)("span",{className:"subtitle is-4",children:["(",e.id,")"]})]}),Object(k.jsx)("p",{className:"subtitle is-5",children:e.description}),Object(k.jsxs)("p",{children:["Sensors connected: ",e.sensors]}),Object(k.jsxs)("p",{children:["Last update: ",e.last_update]})]})})})})),Object(k.jsx)("div",{className:"card m-4",children:Object(k.jsx)(o.b,{to:"/add_room",children:Object(k.jsxs)("div",{className:"card-content",children:[Object(k.jsx)("p",{className:"title is-3",children:"Add room"}),Object(k.jsx)("p",{className:"subtitle is-1 has-text-success",children:Object(k.jsx)(R.a,{icon:_.a})})]})})})]})]})},E=function(){var e=Object(i.h)().room_id,t=Object(i.g)(),n=Object(l.d)((function(e){return e.removeRoom})),c=Object(l.d)((function(e){return e.setSensors})),a=Object(l.e)((function(e){return e.rooms})),r=Object(l.e)((function(e){return e.sensors})),u=a.filter((function(t){return t.id==e}))[0];return Object(s.useEffect)((function(){N(e).then((function(e){return c(e.sensors)}))}),[e]),Object(k.jsxs)("div",{className:"column",children:[Object(k.jsxs)("div",{className:"is-flex is-justify-content-space-between",children:[Object(k.jsx)("p",{className:"title is-3 mt-4 ml-2",children:u.name}),Object(k.jsx)("p",{onClick:function(){f(e).then((function(s){s.message&&(t.push("/"),n(e))}))},className:"has-text-danger p-4 m-4 title is-5",children:Object(k.jsx)(R.a,{icon:_.b})})]}),Object(k.jsxs)("p",{className:"subtitle is-5 ml-4",children:["Updated at: ",u.last_update]}),Object(k.jsxs)("div",{class:"is-flex is-flex-wrap-wrap",children:[r.map((function(t){return Object(k.jsx)("div",{className:"card m-4",children:Object(k.jsx)(o.b,{to:"/room/".concat(e,"/sensor/").concat(t.id),children:Object(k.jsxs)("div",{className:"card-content",children:[Object(k.jsx)("p",{className:"title is-3",children:t.name}),Object(k.jsx)("p",{className:"subtitle is-5",children:t.variable}),Object(k.jsxs)("p",{children:[Object(k.jsxs)("span",{className:"",children:[t.value," "]}),Object(k.jsxs)("span",{className:"",children:[t.unit," "]})]})]})})})})),Object(k.jsx)("div",{className:"card m-4",children:Object(k.jsx)(o.b,{to:"/add_sensor/".concat(e),children:Object(k.jsxs)("div",{className:"card-content",children:[Object(k.jsx)("p",{className:"title is-3",children:"Add sensor"}),Object(k.jsx)("p",{className:"subtitle is-1 has-text-success",children:Object(k.jsx)(R.a,{icon:_.a})})]})})})]})]})},A=n(95),D=function(e){var t=new Date(e).getTime();if(t){var n=t/1e3-(new Date).getTime()/1e3,s={when:"now"};return n>0?s.when="future":n<-1&&(s.when="past"),(n=Math.abs(n))/31536e3>1?(s.unitOfTime="years",s.time=Math.floor(n/31536e3)):n/3888e3>1?(s.unitOfTime="months",s.time=Math.floor(n/3888e3)):n/86400>1?(s.unitOfTime="days",s.time=Math.floor(n/86400)):n/3600>1?(s.unitOfTime="hours",s.time=Math.floor(n/3600)):(s.unitOfTime="seconds",s.time=Math.floor(n)),"".concat(s.time," ").concat(s.unitOfTime," ").concat("past"==s.when?"ago":"ahead")}},U=function(){var e=Object(s.useState)(!0),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(i.h)(),r=a.sensor_id,o=a.room_id,j=Object(l.e)((function(e){return e.sensors})),d=Object(l.d)((function(e){return e.removeSensor})),b=j.filter((function(e){return e.id==r}))[0],m=Object(i.g)(),O=Object(l.e)((function(e){return e.measurements})),p=Object(l.d)((function(e){return e.setMeasurements})),h=O.map((function(e){return t=e.updated_at,new Date(t).toLocaleString("sv-SE").split(" ")[1];var t})),x=O.map((function(e){return e.value}));Object(s.useEffect)((function(){console.log("...measurements"),y(o,r).then((function(e){console.log(e.measurements),p(e.measurements)}))}),[r]);return Object(k.jsxs)("div",{className:"column",children:[Object(k.jsxs)("div",{className:"is-flex is-justify-content-space-between",children:[Object(k.jsx)("p",{className:"title is-3 mt-4 ml-2",children:b.name}),Object(k.jsx)("p",{onClick:function(){w(o,r).then((function(e){e.message&&(m.push("/room/".concat(o)),d(r))}))},className:"has-text-danger p-4 m-4 title is-5",children:Object(k.jsx)(R.a,{icon:_.b})})]}),Object(k.jsxs)("p",{className:"subtitle is-5 ml-3",children:["Last update: ",D(b.last_update)]}),Object(k.jsx)("p",{className:"subtitle is-5 ml-3",children:b.description}),Object(k.jsx)("div",{className:"card m-4",children:Object(k.jsx)(A.a,{data:function(){return function(e,t){return{labels:e,datasets:[{label:"Temperature \u0970C",data:t,fill:!1,borderColor:"#2ecc71",tension:.1}]}}(h,x)},options:{animation:{duration:0}}})}),Object(k.jsxs)("div",{className:"is-flex is-justify-content-space-between",children:[Object(k.jsx)("button",{onClick:function(){return c(!0)},className:"button is-outlined ml-4 ".concat(n&&"is-success"),children:"Realtime"}),Object(k.jsxs)("div",{className:"is-flex",children:[Object(k.jsx)("label",{class:"label ml-4",children:"From:"}),Object(k.jsx)("input",{type:"date",className:"input ml-2 ".concat(!n&&"is-success")}),Object(k.jsx)("label",{class:"label ml-4",children:"To:"}),Object(k.jsx)("input",{type:"date",className:"input ml-2 ".concat(!n&&"is-success")}),Object(k.jsx)("button",{onClick:function(){return c(!1)},className:"button is-outlined ml-4 mr-4 ".concat(!n&&"is-success"),children:"Query"})]})]})]})},I=n(23),L=n(7),q={rooms:[],setRooms:Object(l.b)((function(e,t){e.rooms=Object(L.a)(t)})),addRoom:Object(l.b)((function(e,t){e.rooms.push(t)})),removeRoom:Object(l.b)((function(e,t){e.rooms=e.rooms.filter((function(e){return e.id!=t}))})),updateRoom:Object(l.b)((function(e,t,n){e.rooms=e.rooms.map((function(e){return e.id==t?Object(I.a)(Object(I.a)({},e),n):e}))})),sensors:[],setSensors:Object(l.b)((function(e,t){e.sensors=Object(L.a)(t)})),removeSensor:Object(l.b)((function(e,t){e.sensors=e.sensors.filter((function(e){return e.id!=t}))})),measurements:[],setMeasurements:Object(l.b)((function(e,t){e.measurements=Object(L.a)(t)}))},J=Object(l.c)(q),B=function(){return Object(k.jsx)("div",{className:"container mt-4",children:Object(k.jsx)("div",{className:"columns",children:Object(k.jsxs)(l.a,{store:J,children:[Object(k.jsx)(T,{}),Object(k.jsxs)(i.d,{children:[Object(k.jsx)(i.a,{exact:!0,from:"/",to:"/rooms"}),Object(k.jsx)(i.b,{path:"/rooms",component:M}),Object(k.jsx)(i.b,{path:"/room/:room_id/sensor/:sensor_id",component:U}),Object(k.jsx)(i.b,{path:"/room/:room_id",component:E}),Object(k.jsx)(i.b,{path:"/add_room",component:S}),Object(k.jsx)(i.b,{path:"/add_sensor/:room_id",component:C})]})]})})})};r.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(o.a,{children:Object(k.jsx)(B,{})})}),document.getElementById("root"))}},[[233,1,2]]]);
//# sourceMappingURL=main.cfab6231.chunk.js.map